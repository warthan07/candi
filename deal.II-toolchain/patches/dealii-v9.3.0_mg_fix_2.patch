From 786db18d57cde96c55f8bc943d29fcaf015088b5 Mon Sep 17 00:00:00 2001
From: Peter Munch <peterrmuench@gmail.com>
Date: Mon, 6 Sep 2021 15:58:05 +0200
Subject: [PATCH] Fix MGTransferGlobalCoarsening::copy_to_mg()

---
 .../deal.II/multigrid/mg_transfer_global_coarsening.h | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/include/deal.II/multigrid/mg_transfer_global_coarsening.h b/include/deal.II/multigrid/mg_transfer_global_coarsening.h
index 64bbd4aa1e..d59f1dddd9 100644
--- a/include/deal.II/multigrid/mg_transfer_global_coarsening.h
+++ b/include/deal.II/multigrid/mg_transfer_global_coarsening.h
@@ -608,9 +608,14 @@ MGTransferGlobalCoarsening<dim, VectorType>::copy_to_mg(
       "MGTransferGlobalCoarsening."));
 
   for (unsigned int level = dst.min_level(); level <= dst.max_level(); ++level)
-    initialize_dof_vector(level, dst[level]);
-
-  dst[dst.max_level()].copy_locally_owned_data_from(src);
+    {
+      initialize_dof_vector(level, dst[level]);
+
+      if (level == dst.max_level())
+        dst[level].copy_locally_owned_data_from(src);
+      else
+        dst[level] = 0.0;
+    }
 }
 
 
-- 
2.33.0

